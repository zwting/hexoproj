---
title: Quaternion学习
date: 2018-07-02 15:26:00
tags: [数学, 图形学]
comment: true
---

#### 1.四元数的记法

一个四元数包含一个标量和一个3D分量, 通常标量分量记为**w**, 向量分量记为**v**或者分开的x, y, z。这两种记法可以用如下的形式来表示:
> $[w, v]$
> $[w, (x, y, z)]$

#### 2.复数

>提示： 学习图形学的过程中，数学是在所难免的，所以，尽力去理解吧

>让我们先从复数说起吧

+ ##### 2.1复数
复数对$(a,b)$定义了数$a + bi$, i 是所谓的虚数部分, 满足$i^2 = -1: a $称为实部: b 称为虚部。任意实数k都可以表示为复数(令虚部为0即可)$(k,0) = k + 0i$。
+ ##### 2.2 复数的加法、减法和乘法
加法： $(a + bi) + (c + di) = (a + c) + (b + d)i$
减法： $(a + bi) - (c + di) = (a - c) + (b - d)i$
乘法： $\begin{aligned}(a + bi)(c + di) &= ac + adi + bci + bdi^2 \\\\
&= ac + (ad + bc)i + bd(-1)  \\\\
&= (ac - bd) + (ad + bc)i\end{aligned}$

+ ##### 2.3 共轭复数
令复数的虚部变负，可以得到复数的**共轭**, 记法如下:
$p = (a + bi)$
$p^* = (a - bi)$

+ ##### 2.4 求复数的模
$\left\\| p \right\\| = \sqrt{pp^*}$
$\begin{aligned}\left\\| a + bi \right\\| &= \sqrt{(a + bi) (a + bi)^\ast } \\\\
&= \sqrt{(a + bi)(a - bi)} \\\\
&= \sqrt{a^2 - (bi)^2 - abi + abi} \\\\
&= \sqrt{a^2 + b^2}
\end{aligned}$

#### 3.四元数
> 简单介绍了下复数的基本运算，接下来我们来看四元数

+ ##### 3.1 四元数的介绍
爱尔兰数学家William Hamilton多年来一直致力于寻找一种方法将复数从2D扩展到3D。开始他认为新的复数应该有一个实部和两个虚部而，Hamilton一直没有办法创造出一种有两个虚部的有意义的复数。直到1843年，在赴皇家爱尔兰学院演讲的路上，他突然意识到应该有三个虚部而非两个。这样，四元数就诞生了。
四元数扩展了复数系统，它使用三个虚部$i, j, k$。他们有如下关系：
$
i^2 = j^2 = k^2 = -1 \\\\
ij = k, ij = -k \\\\
jk = i, kj = -i \\\\
ki = j, ik = -j
$
+ ##### 3.2 四元数来表示旋转
欧拉证明了一个旋转序列等价于单个旋转。因此，3D中的任意角位移都可以表示为绕单一轴的单一旋转(这里的旋转轴指的是空间中的任意一个方向，通常用一个单位向量表示这个旋转轴)。试想一下，我们可以让四元素的三个虚部表示旋转轴$n$，虚部表示旋转的角度$\theta$，是不是可以用来表示前述的角位移。But!!! 很遗憾，$n$和$\theta$并不是直接简单的存储在四元数中的，欲知真相如何，请看下述公式：
$\begin{aligned}q &= [cos(\theta / 2)\ sin(\theta / 2)n] \\\\
&= [cos(\theta / 2)\quad (sin(\theta / 2)n_x \ sin(\theta / 2)n_y \ sin(\theta / 2)n_z)]
\end{aligned}$

+ ##### 3.3 负四元数
四元数能够求负。做法很直接：直接将每个分量都变负，见如下公式：
$\begin{aligned}
-q &= -[w \quad (x \quad y \quad z)] = [-w \quad (-x \quad -y \quad -z)] \\\\
&= -[w \quad v] = [-w \quad -v]
\end{aligned}$
$q$和$-q$代表的角位移其实是相同的

+ ##### 3.4 单位四元数
其实在几何意义上，存在着两个“单位”四元数。他们都表示没有角位移：$[1, 0]$和$[-1, 0]$。当$\theta$是360的偶数倍时，是第一种形式，$cos(\theta  / 2) = 1$, $\theta$是360的奇数倍时，是第二种形式, $cos(\theta / 2) = -1$。不管是哪一种 情况，都有$sin(\theta / 2) = 0$, 所以$n$值是无关紧要的。它的意义在于:
当旋转角$\theta$是360的整数倍时，方位并没有发生改变，因此旋转轴也是无关紧要的。
不过在数学上，只有一个单位四元数$[1, 0]$

+ ##### 3.5 四元数的模
和复数一样，四元数也是有模的。记法和公式都和向量类似，如下公式：
$\begin{aligned} \left \\| q \right \\| &= \left \\| [w \quad (x \quad y \quad z)] \right \\| = \sqrt{w^2 + x^2 + y^2 + z^2} \\\\
&= \left \\| [w \quad v] \right \\| = \sqrt{w^2 + \left \\| v \right \\| ^2}
\end{aligned}$

+ ##### 3.6 四元数的共轭和逆
四元数的共轭和复数类似，记作$q^\ast$